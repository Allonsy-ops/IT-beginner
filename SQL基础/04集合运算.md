## 表的加减法

### 表的加法 - UNION求表的并集

    select product_id, product_name
    
    from product
    
    union
    
    select product_id, product_name
    
    from product2
    
**UNION可以删除重复元素**

假设连锁店想要增加毛利率超过 50%或者售价低于 800 的货物的存货量, 请使用 UNION 对分别满足上述两个条件的商品的查询结果求并集.

    select product_id, product_name, product_type, sale_price, purchase_price
    
    from product
    
    where (sale_price - purchase_price)/ purchase_price > 0.5
    
    UNION
    
    select product_id, product_name, product_type, sale_price, purchase_price
    
    from product
    
    where sale_price < 800;
    
如果不用 UNION 就在WHERE子句里使用 OR

分别使用 UNION 或者 OR 谓词,找出毛利率不足 30%或毛利率未知的商品。

    -- UNION
    
    select * 
    
    from product
    
    where sale_price < 1.3 * purchase_price
    
    union
    
    select * 
    
    from product
    
    where (sale_price - purchase_price)/ purchase_price IS NULL;
    
    -- OR
    
    select * 
    
    from product
    
    where sale_price < 1.3 * purchase_price
    
    OR (sale_price - purchase_price)/ purchase_price IS NULL;
    
对同一张表，UNION和OR可以达到同样的效果，OR语句简洁，但UNION查询效率更高。

对不同表，不得不使用UNION。

**选择不去除重复行 UNION ALL**

    -- 保留重复行
    
    SELECT product_id, product_name
    
    FROM product
    
    UNION ALL
    
    SELECT product_id, product_name
    
    FROM product2;

### bag模型与set模型

一个集合set中，所有元素都是互异的。

一个袋子bag中，允许重复元素存在。数据库中的表实际上包含重复行，因此用bag描述数据库中的表更合适。

由于以上不同，set和bag的交并差等运算存在一些区别。对于两个bag，它们之间的并运算会计算两部分:
 1.该元素是否在至少一个bag内存在。 2.该元素在两个bag内出现的最大次数。 例如，A={1，1，1，2，3，5，7} 
 ，B={1，1，2，2，4，6，8} A并B={1,1,1,2,2,3,4,5,6,7,8}
 
 
